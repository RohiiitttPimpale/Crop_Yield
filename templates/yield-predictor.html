<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartAgri - AI Yield Predictor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        * { font-family: 'Inter', sans-serif; }
        .pulse-animation { animation: pulse 2s ease-in-out infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 via-blue-50 to-emerald-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-md border-b border-purple-200 px-8 py-4">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-4">
                <a href="{{ url_for('dashboard') }}" class="p-2 hover:bg-gray-100 rounded-lg transition-colors">
                    <i data-lucide="arrow-left" class="w-5 h-5 text-gray-600"></i>
                </a>
                <div>
                    <h1 class="text-2xl font-bold text-gray-800">AI Yield Predictor</h1>
                    <p class="text-gray-600">Get AI-powered yield predictions</p>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-4xl mx-auto p-8">
        <!-- Prediction Form -->
        <div class="bg-white/70 backdrop-blur-sm rounded-2xl p-8 border border-purple-100 mb-8">
            <div class="flex items-center mb-6">
                <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-xl flex items-center justify-center mr-4">
                    <i data-lucide="brain" class="w-6 h-6 text-white"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-800">Predict Your Crop Yield</h2>
            </div>

            <form method="POST" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Crop Type</label>
                        <select name="crop" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent" required>
                            <option value="">Select Crop</option>
                            <option value="rice">Rice</option>
                            <option value="wheat">Wheat</option>
                            <option value="corn">Corn</option>
                            <option value="tomatoes">Tomatoes</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Area (acres)</label>
                        <input type="number" name="area" step="0.1" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="Enter area" required>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Soil pH</label>
                        <input type="number" name="ph" step="0.1" min="4.0" max="9.0" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="6.8" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Rainfall (mm)</label>
                        <input type="number" name="rainfall" step="0.01" min="0" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="750" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Temperature (Â°C)</label>
                        <input type="number" name="temper" step="0.01" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent" placeholder="28" required>
                    </div>
                </div>

                <div class="flex justify-center">
                    <button type="submit" class="px-8 py-4 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-xl hover:from-purple-600 hover:to-indigo-700 transition-all duration-300 shadow-lg font-medium">
                        <i data-lucide="zap" class="w-5 h-5 mr-2 inline"></i>
                        Generate AI Prediction
                    </button>
                </div>
            </form>
        </div>

        <!-- Prediction Results -->
        {% if produce > 0 %}
        <div class="bg-white/70 backdrop-blur-sm rounded-2xl p-8 border border-green-100 animate-fade-in">
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-gradient-to-r from-green-500 to-emerald-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <i data-lucide="trending-up" class="w-10 h-10 text-white"></i>
                </div>
                <h3 class="text-3xl font-bold text-gray-800 mb-2">AI Predicted Yield</h3>
                <div class="text-6xl font-bold text-green-600 mb-2">{{ "%.2f"|format(produce) }}</div>
                <div class="text-xl text-gray-600">tons total expected yield</div>
                <div class="text-lg text-gray-500 mt-2">Based on your input parameters</div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="text-center p-6 bg-blue-50 rounded-xl">
                    <i data-lucide="target" class="w-8 h-8 text-blue-600 mx-auto mb-3"></i>
                    <div class="text-2xl font-bold text-blue-600">95%</div>
                    <div class="text-gray-600">AI Confidence</div>
                </div>
                <div class="text-center p-6 bg-purple-50 rounded-xl">
                    <i data-lucide="brain" class="w-8 h-8 text-purple-600 mx-auto mb-3"></i>
                    <div class="text-2xl font-bold text-purple-600">ML</div>
                    <div class="text-gray-600">Algorithm Used</div>
                </div>
                <div class="text-center p-6 bg-emerald-50 rounded-xl">
                    <i data-lucide="database" class="w-8 h-8 text-emerald-600 mx-auto mb-3"></i>
                    <div class="text-2xl font-bold text-emerald-600">10K+</div>
                    <div class="text-gray-600">Training Records</div>
                </div>
            </div>

            <div class="bg-yellow-50 border border-yellow-200 rounded-xl p-6">
                <h4 class="font-bold text-gray-800 mb-3 flex items-center">
                    <i data-lucide="lightbulb" class="w-5 h-5 text-yellow-600 mr-2"></i>
                    Smart Farming Recommendations
                </h4>
                <ul class="space-y-2 text-gray-700">
                    {% if produce > 4.0 %}
                    <li class="flex items-start space-x-2">
                        <i data-lucide="check" class="w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"></i>
                        <span>Excellent prediction! Current conditions are optimal for high yield</span>
                    </li>
                    {% elif produce > 2.0 %}
                    <li class="flex items-start space-x-2">
                        <i data-lucide="alert-triangle" class="w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"></i>
                        <span>Good prediction. Consider optimizing irrigation for better results</span>
                    </li>
                    {% else %}
                    <li class="flex items-start space-x-2">
                        <i data-lucide="alert-circle" class="w-4 h-4 text-red-600 mt-0.5 flex-shrink-0"></i>
                        <span>Yield seems low. Review soil conditions and fertilizer application</span>
                    </li>
                    {% endif %}

                    <li class="flex items-start space-x-2">
                        <i data-lucide="droplets" class="w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"></i>
                        <span>Monitor soil moisture levels regularly during growing season</span>
                    </li>
                    <li class="flex items-start space-x-2">
                        <i data-lucide="thermometer" class="w-4 h-4 text-orange-600 mt-0.5 flex-shrink-0"></i>
                        <span>Keep track of temperature variations that may affect growth</span>
                    </li>
                    <li class="flex items-start space-x-2">
                        <i data-lucide="leaf" class="w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"></i>
                        <span>Consider using organic fertilizers to improve soil health</span>
                    </li>
                </ul>
            </div>

            <!-- Action Buttons -->
            <div class="flex justify-center space-x-4 mt-8">
                <button onclick="window.print()" class="px-6 py-3 bg-gray-600 text-white rounded-xl hover:bg-gray-700 transition-colors">
                    <i data-lucide="printer" class="w-4 h-4 mr-2 inline"></i>
                    Print Report
                </button>
                <a href="{{ url_for('crop_planning') }}" class="px-6 py-3 bg-emerald-600 text-white rounded-xl hover:bg-emerald-700 transition-colors">
                    <i data-lucide="calendar" class="w-4 h-4 mr-2 inline"></i>
                    Plan Crop Cycle
                </a>
                <form method="GET" style="display: inline;">
                    <button type="submit" class="px-6 py-3 bg-purple-600 text-white rounded-xl hover:bg-purple-700 transition-colors">
                        <i data-lucide="refresh-cw" class="w-4 h-4 mr-2 inline"></i>
                        New Prediction
                    </button>
                </form>
            </div>
        </div>
        {% elif request.method == 'POST' %}
        <div class="bg-red-50 border border-red-200 rounded-2xl p-8">
            <div class="text-center">
                <i data-lucide="alert-circle" class="w-16 h-16 text-red-500 mx-auto mb-4"></i>
                <h3 class="text-xl font-bold text-red-800 mb-2">Prediction Error</h3>
                <p class="text-red-600">Unable to generate prediction. Please check your input values and try again.</p>
            </div>
        </div>
        {% endif %}

        <!-- How It Works Section -->
        <div class="mt-8 bg-white/50 backdrop-blur-sm rounded-2xl p-6 border border-gray-100">
            <h3 class="text-xl font-bold text-gray-800 mb-4">How Our AI Prediction Works</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="text-center">
                    <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3">
                        <i data-lucide="database" class="w-6 h-6 text-blue-600"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">Data Collection</h4>
                    <p class="text-sm text-gray-600">We analyze soil pH, rainfall, temperature, and other environmental factors</p>
                </div>
                <div class="text-center">
                    <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center mx-auto mb-3">
                        <i data-lucide="brain" class="w-6 h-6 text-purple-600"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">ML Processing</h4>
                    <p class="text-sm text-gray-600">Advanced machine learning algorithms process your data against historical patterns</p>
                </div>
                <div class="text-center">
                    <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mx-auto mb-3">
                        <i data-lucide="trending-up" class="w-6 h-6 text-green-600"></i>
                    </div>
                    <h4 class="font-semibold text-gray-800 mb-2">Prediction</h4>
                    <p class="text-sm text-gray-600">Get accurate yield predictions with actionable farming recommendations</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();

        // Add fade-in animation
        const style = document.createElement('style');
        style.textContent = `
            .animate-fade-in {
                animation: fadeIn 0.8s ease-in-out;
            }
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
            }
        `;
        document.head.appendChild(style);

        // Auto-scroll to results if prediction was made
        {% if produce > 0 %}
        setTimeout(() => {
            const resultsSection = document.querySelector('.animate-fade-in');
            if (resultsSection) {
                resultsSection.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
            }
        }, 300);
        {% endif %}
    </script>
</body>
</html>